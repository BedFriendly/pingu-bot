# Pingu Bot - 프로젝트 로드맵

## 개발 원칙

- **MVP 우선**: 핵심 기능부터 완성
- **반복적 개발**: 작동하는 버전을 먼저 만들고 개선
- **테스트 주도**: 각 기능은 테스트 후 다음 단계로
- **문서화**: 코드와 함께 문서 업데이트

## Phase 0: 프로젝트 설정 (Foundation)

### 목표

기본 개발 환경 구축 및 프로젝트 구조 생성

### 작업 항목

#### 1. 프로젝트 초기화

- [x] Git 저장소 생성
- [ ] Node.js 프로젝트 초기화 (`npm init`)
- [ ] TypeScript 설정 (`tsconfig.json`)
- [ ] 폴더 구조 생성
- [ ] `.gitignore` 설정
- [ ] `.env.example` 생성

#### 2. 의존성 설치

```bash
# Core
npm install discord.js
npm install dotenv

# Database
npm install better-sqlite3
npm install @types/better-sqlite3 --save-dev

# Development
npm install -D typescript @types/node
npm install -D eslint prettier
npm install -D @typescript-eslint/eslint-plugin
npm install -D @typescript-eslint/parser
npm install -D nodemon ts-node
```

#### 3. 개발 도구 설정

- [ ] ESLint 설정
- [ ] Prettier 설정
- [ ] npm scripts 구성
  - `dev`: 개발 모드 실행
  - `build`: TypeScript 컴파일
  - `start`: 프로덕션 실행
  - `lint`: 코드 검사
  - `test`: 테스트 실행

#### 4. Discord Bot 설정

- [ ] Discord Developer Portal에서 애플리케이션 생성
- [ ] 봇 토큰 발급
- [ ] 필요한 Intents 설정
- [ ] OAuth2 URL 생성

### 완료 기준

- [ ] `npm run dev`로 봇이 실행됨
- [ ] 봇이 Discord에 온라인 상태로 표시됨
- [ ] TypeScript 컴파일 오류 없음
- [ ] Git에 첫 커밋 완료

---

## Phase 1: 핵심 인프라 (Core Infrastructure)

### 목표

봇의 기본 구조 및 명령어 시스템 구축

### 작업 항목

#### 1. Bot 클래스 구현

- [ ] PinguBot 클래스 생성
- [ ] Client 초기화 및 Intents 설정
- [ ] 명령어 Collection 구조 생성
- [ ] 로그인 로직 구현

#### 2. Command Handler 시스템

- [ ] Command 인터페이스 정의
- [ ] 명령어 동적 로딩 구현
- [ ] Slash Command 등록 로직
- [ ] 명령어 실행 핸들러

#### 3. Event Handler 시스템

- [ ] Event 인터페이스 정의
- [ ] 이벤트 동적 로딩 구현
- [ ] `ready` 이벤트 핸들러
- [ ] `interactionCreate` 이벤트 핸들러

#### 4. Database 설정

- [ ] SQLite 연결 설정
- [ ] 스키마 파일 작성 (`schema.sql`)
- [ ] 초기 마이그레이션 스크립트
- [ ] Database 클래스 구현

#### 5. 기본 유틸리티

- [ ] Logger 구현 (console 기반)
- [ ] Embed 생성 헬퍼
- [ ] 환경 변수 관리 (`config.ts`)

#### 6. 첫 명령어 구현

- [ ] `/ping` 명령어 (테스트용)
- [ ] `/help` 명령어 (기본 도움말)

### 완료 기준

- [ ] 슬래시 명령어가 Discord에 등록됨
- [ ] `/ping` 실행 시 응답 받음
- [ ] `/help` 실행 시 명령어 목록 표시
- [ ] 데이터베이스 연결 성공
- [ ] 콘솔에 구조화된 로그 출력

---

## Phase 2: 경제 시스템 (Economy System)

### 목표

가상 화폐 시스템 및 기본 경제 기능 구현

### 작업 항목

#### 1. 데이터 모델

- [ ] User 모델 구현
- [ ] Guild 모델 구현
- [ ] CRUD 메서드 작성

#### 2. Economy Service

- [ ] EconomyService 클래스 생성
- [ ] 잔액 조회 로직
- [ ] 코인 추가/차감 로직
- [ ] 코인 전송 로직 (트랜잭션)

#### 3. 경제 명령어 구현

- [ ] `/balance` - 잔액 확인
- [ ] `/daily` - 일일 보상
  - 24시간 쿨다운 구현
  - 랜덤 보상 (100-500 PC)
- [ ] `/pay` - 코인 전송
  - 입력 검증 (최소 금액, 본인 전송 방지)
  - 잔액 부족 체크
- [ ] `/leaderboard` - 랭킹
  - 코인 랭킹 (상위 10명)
  - Embed로 시각화

#### 4. Cooldown 시스템

- [ ] Cooldown 미들웨어 구현
- [ ] 쿨다운 메모리 캐싱
- [ ] 쿨다운 남은 시간 표시

### 완료 기준

- [ ] 모든 경제 명령어가 정상 작동
- [ ] 일일 보상 24시간 제한 적용
- [ ] 코인 전송 시 트랜잭션 처리 (원자성)
- [ ] 랭킹이 정확하게 표시됨
- [ ] 데이터베이스에 데이터 저장 확인

---

## Phase 3: 미니 게임 (Mini Games)

### 목표

재미있는 게임 명령어 구현 및 베팅 시스템

### 작업 항목

#### 1. Game Service

- [ ] GameService 클래스 생성
- [ ] 게임 결과 기록 로직
- [ ] GameStats 모델 구현

#### 2. 주사위 게임

- [ ] `/dice` 명령어
- [ ] 주사위 개수/면수 파라미터
- [ ] 결과 시각화

#### 3. 가위바위보

- [ ] `/rps` 명령어
- [ ] 봇 AI (랜덤 선택)
- [ ] 승/패/무 판정
- [ ] 베팅 시스템 추가
- [ ] 승리 시 코인 2배 지급

#### 4. 코인 플립

- [ ] `/coinflip` 명령어
- [ ] Heads/Tails 예측
- [ ] 베팅 금액 파라미터
- [ ] 50% 확률 구현

#### 5. 숫자 맞추기

- [ ] `/guess` 명령어
- [ ] 1-100 랜덤 숫자 생성
- [ ] 힌트 시스템 ("더 높아요", "더 낮아요")
- [ ] 시도 횟수 기반 보상
- [ ] 세션 관리 (진행 중인 게임)

#### 6. 롤 명령어

- [ ] `/roll` 명령어 (1-100 랜덤)

### 완료 기준

- [ ] 모든 게임이 정상 작동
- [ ] 베팅 시스템이 정확하게 동작
- [ ] 게임 통계가 데이터베이스에 저장
- [ ] 잔액 부족 시 베팅 불가
- [ ] 게임 결과가 직관적으로 표시

---

## Phase 4: 레벨링 시스템 (Leveling System)

### 목표

메시지 기반 경험치 및 레벨 시스템 구현

### 작업 항목

#### 1. Leveling Service

- [ ] LevelingService 클래스 생성
- [ ] XP 계산 공식 구현
- [ ] 레벨업 체크 로직
- [ ] 메시지 쿨다운 관리 (60초)

#### 2. Message Event Handler

- [ ] `messageCreate` 이벤트 구현
- [ ] 봇 메시지 제외
- [ ] XP 부여 (15-25 랜덤)
- [ ] 쿨다운 체크

#### 3. 레벨업 시스템

- [ ] 레벨업 감지
- [ ] 축하 메시지 전송
- [ ] 보상 코인 지급 (레벨 × 100 PC)
- [ ] 설정된 채널에 알림 (optional)

#### 4. Level 명령어

- [ ] `/level` 명령어
- [ ] 자신/타인 레벨 조회
- [ ] 프로그레스 바 시각화
- [ ] Embed로 정보 표시

#### 5. Leaderboard 확장

- [ ] `/leaderboard level` 옵션 추가
- [ ] 레벨+XP 기준 정렬

### 완료 기준

- [ ] 메시지 전송 시 XP 획득
- [ ] 60초 쿨다운 정상 작동
- [ ] 레벨업 시 알림 메시지
- [ ] `/level` 명령어로 정확한 정보 표시
- [ ] 레벨 랭킹 정상 작동

---

## Phase 5: 재미 명령어 (Fun Commands)

### 목표

사용자 참여를 높이는 재미있는 명령어 구현

### 작업 항목

#### 1. Image Service

- [ ] ImageService 클래스 생성
- [ ] Unsplash API 연동
- [ ] 이미지 캐싱 (optional)

#### 2. 펭귄 이미지

- [ ] `/penguin` 명령어
- [ ] Unsplash에서 랜덤 펭귄 이미지 검색
- [ ] 이미지 Embed 표시

#### 3. 8볼 (Magic 8 Ball)

- [ ] `/8ball` 명령어
- [ ] 질문 파라미터
- [ ] 답변 모음 (긍정/부정/중립)
- [ ] 랜덤 답변 선택

#### 4. 선택 도우미

- [ ] `/choose` 명령어
- [ ] 여러 선택지 파라미터 (공백 구분)
- [ ] 랜덤 선택

### 완료 기준

- [ ] 모든 재미 명령어가 작동
- [ ] 외부 API 호출 정상 동작
- [ ] 에러 처리 (API 실패 시)
- [ ] 응답이 재미있고 직관적

---

## Phase 6: 서버 관리 & 유틸리티 (Admin & Utility)

### 목표

서버 설정 및 편의 기능 구현

### 작업 항목

#### 1. 서버 설정

- [ ] `/config` 명령어 (관리자 전용)
- [ ] 레벨업 알림 채널 설정
- [ ] 환영 메시지 채널 설정
- [ ] 언어 설정 (ko/en)

#### 2. 환영 메시지

- [ ] `guildMemberAdd` 이벤트 핸들러
- [ ] 설정된 채널에 환영 메시지
- [ ] 커스터마이징 가능한 템플릿

#### 3. Help 명령어 개선

- [ ] 카테고리별 명령어 분류
- [ ] 상세 도움말 (명령어별)
- [ ] 페이지네이션 (optional)

#### 4. Info 명령어

- [ ] `/info` 명령어
- [ ] 봇 정보 (버전, 업타임 등)
- [ ] 서버 통계

#### 5. 권한 시스템

- [ ] 관리자 권한 체크 미들웨어
- [ ] 명령어별 권한 설정

### 완료 기준

- [ ] 서버 설정이 데이터베이스에 저장
- [ ] 관리자만 설정 명령어 사용 가능
- [ ] 새 멤버 입장 시 환영 메시지 전송
- [ ] `/help`가 모든 명령어를 표시

---

## Phase 7: 테스트 & 품질 개선 (Testing & Quality)

### 목표

코드 품질 향상 및 안정성 확보

### 작업 항목

#### 1. 단위 테스트

- [ ] Jest 설정
- [ ] LevelingService 테스트
- [ ] EconomyService 테스트
- [ ] GameService 테스트
- [ ] 유틸리티 함수 테스트

#### 2. 통합 테스트

- [ ] 명령어 실행 테스트 (mocking)
- [ ] 데이터베이스 트랜잭션 테스트

#### 3. 에러 핸들링 강화

- [ ] Custom Error 클래스 구현
- [ ] 계층별 에러 처리
- [ ] 사용자 친화적 에러 메시지

#### 4. 로깅 개선

- [ ] 파일 로깅 추가
- [ ] 로그 레벨 분리
- [ ] 에러 스택 트레이스

#### 5. 코드 리팩토링

- [ ] 중복 코드 제거
- [ ] 매직 넘버 상수화
- [ ] 타입 안정성 강화

#### 6. 입력 검증

- [ ] 모든 명령어 파라미터 검증
- [ ] 범위 체크 (금액, 레벨 등)
- [ ] SQL Injection 방지 확인

### 완료 기준

- [ ] 테스트 커버리지 50% 이상
- [ ] 모든 테스트 통과
- [ ] ESLint 경고 없음
- [ ] 주요 경로 에러 핸들링 완료

---

## Phase 8: 배포 준비 (Deployment)

### 목표

프로덕션 환경 배포 준비

### 작업 항목

#### 1. 환경 설정

- [ ] 환경별 설정 분리 (dev/prod)
- [ ] 환경 변수 검증
- [ ] `.env.example` 업데이트

#### 2. 프로덕션 최적화

- [ ] TypeScript 빌드 최적화
- [ ] 불필요한 의존성 제거
- [ ] 데이터베이스 인덱스 추가

#### 3. 배포 설정

- [ ] PM2 설정 파일 (`ecosystem.config.js`)
- [ ] 자동 재시작 설정
- [ ] 메모리 제한 설정

#### 4. Railway 배포

- [ ] Railway 프로젝트 생성
- [ ] 환경 변수 설정
- [ ] 데이터베이스 영구 스토리지 설정
- [ ] 배포 및 테스트

#### 5. 모니터링 설정

- [ ] 에러 로깅 (Sentry 또는 Better Stack)
- [ ] 업타임 모니터링
- [ ] 알림 설정

### 완료 기준

- [ ] 프로덕션 환경에서 봇 정상 작동
- [ ] 재시작 시 자동 복구
- [ ] 에러 발생 시 알림 수신
- [ ] 데이터베이스 영구 저장

---

## Phase 9: 문서화 & 릴리즈 (Documentation & Release)

### 목표

사용자 및 개발자 문서 작성, v1.0 릴리즈

### 작업 항목

#### 1. 사용자 문서

- [ ] README.md 작성
  - 봇 소개
  - 초대 링크
  - 명령어 목록
  - 기능 설명
- [ ] 명령어 가이드 (docs/COMMANDS.md)

#### 2. 개발자 문서

- [ ] 설치 가이드 (docs/SETUP.md)
- [ ] 기여 가이드 (CONTRIBUTING.md)
- [ ] API 문서 (docs/API.md)
- [ ] 코드 주석 추가

#### 3. 라이선스

- [ ] LICENSE 파일 추가 (MIT 권장)

#### 4. 릴리즈

- [ ] v1.0.0 태그 생성
- [ ] GitHub Release 작성
- [ ] 변경 로그 (CHANGELOG.md)

#### 5. 홍보 자료

- [ ] 봇 아바타 및 배너
- [ ] 스크린샷 준비
- [ ] Discord Bot 리스팅 사이트 등록 (optional)

### 완료 기준

- [ ] 모든 문서가 최신 상태
- [ ] README가 봇을 명확하게 설명
- [ ] 설치 가이드대로 따라하면 설치 가능
- [ ] v1.0.0 릴리즈 완료

---

## Phase 10: 피드백 & 개선 (Feedback & Iteration)

### 목표

사용자 피드백 수집 및 반영

### 작업 항목

#### 1. 피드백 수집

- [ ] 테스트 서버에 배포
- [ ] 사용자 피드백 수집
- [ ] 버그 리포트 추적

#### 2. 개선 사항 반영

- [ ] UI/UX 개선
- [ ] 명령어 응답 속도 최적화
- [ ] 추가 기능 요청 검토

#### 3. 성능 모니터링

- [ ] 응답 시간 측정
- [ ] 메모리 사용량 모니터링
- [ ] 병목 지점 파악 및 최적화

#### 4. 버그 수정

- [ ] 발견된 버그 수정
- [ ] 엣지 케이스 처리

### 완료 기준

- [ ] 주요 버그 모두 수정
- [ ] 사용자 피드백 반영
- [ ] 안정적인 운영
- [ ] v1.1.0 릴리즈 준비

---

## 미래 로드맵 (Future Roadmap)

### v1.1.0

- [ ] 추가 미니 게임 (블랙잭, 슬롯머신)
- [ ] 프로필 커스터마이징
- [ ] 업적 시스템

### v1.2.0

- [ ] 상점 시스템 (아이템 구매)
- [ ] 인벤토리 시스템
- [ ] 아이템 거래

### v2.0.0

- [ ] PostgreSQL 마이그레이션
- [ ] Redis 캐싱
- [ ] 웹 대시보드
- [ ] 다국어 지원 확장

---

## 마일스톤 요약

| Phase | 목표          | 주요 결과물                                  |
| ----- | ------------- | -------------------------------------------- |
| 0     | 프로젝트 설정 | 개발 환경, 폴더 구조                         |
| 1     | 핵심 인프라   | Bot 클래스, Command/Event 시스템             |
| 2     | 경제 시스템   | `/daily`, `/balance`, `/pay`, `/leaderboard` |
| 3     | 미니 게임     | `/dice`, `/rps`, `/coinflip`, `/guess`       |
| 4     | 레벨링 시스템 | 메시지 XP, `/level`                          |
| 5     | 재미 명령어   | `/penguin`, `/8ball`, `/choose`              |
| 6     | 관리 & 유틸   | `/config`, 환영 메시지, `/help`, `/info`     |
| 7     | 테스트 & 품질 | 단위 테스트, 에러 핸들링                     |
| 8     | 배포          | Railway 배포, 모니터링                       |
| 9     | 문서화        | README, 가이드, v1.0 릴리즈                  |
| 10    | 피드백 & 개선 | 버그 수정, 최적화, v1.1 준비                 |

---

## 개발 우선순위

### High Priority (MVP)

1. Phase 1: 핵심 인프라
2. Phase 2: 경제 시스템
3. Phase 3: 미니 게임
4. Phase 4: 레벨링 시스템

### Medium Priority

5. Phase 5: 재미 명령어
6. Phase 6: 관리 & 유틸리티

### Low Priority

7. Phase 7: 테스트 & 품질
8. Phase 8: 배포
9. Phase 9: 문서화

---

## 참고 사항

- 각 Phase는 독립적으로 완성되어야 함
- 다음 Phase로 넘어가기 전 완료 기준 충족 확인
- 진행 중 발견된 이슈는 즉시 기록 및 처리
- 정기적인 코드 리뷰 및 리팩토링
